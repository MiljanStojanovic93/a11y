import{_ as $}from"./nuxt-link.9e88655f.js";import{_ as N}from"./Spinner.022385d5.js";import{d as S,r as k,p as C,b as x,o as t,q as y,a0 as A,g as l,f as h,v as w,e as d,c as n,F as v,z as P,j as a,t as L,$ as V,y as Y,m as E,n as I,a as B}from"./entry.bde0faaf.js";import"./_plugin-vue_export-helper.c27b6911.js";const M=({id:f,axeId:e,status:s,reportType:p})=>s==="completed"?`/audit/report/${f}?type=${p}`:`/audit/${f}?resultId=${e}`,q={key:1,"aria-labelledby":"audits-card-title"},z={class:"text-left"},D={class:"p-button p-button-info ml-4 min-w-[116px] justify-center"},F={key:1,class:"border border-transparent px-4 py-3.5 text-left leading-normal"},T={key:2},U=S({__name:"AuditList",props:{audits:{},initialCount:{default:0},isLoading:{type:Boolean,default:!1}},setup(f){const e=f,s=k(e.initialCount?e.initialCount:e.audits.length),p=C(()=>e.audits.slice(0,s.value));return(c,u)=>{const g=N,i=$,b=x("Card");return t(),y(b,null,A({title:l(()=>[u[0]||(u[0]=d("h2",{id:"audits-card-title"},"Your recent audits",-1))]),content:l(()=>[c.isLoading?(t(),y(g,{key:0,class:"mx-auto w-20"})):c.audits.length?(t(),n("ul",q,[(t(!0),n(v,null,P(a(p),({id:r,config:o,axe:_,status:m,report_type:j})=>(t(),n("li",{key:r},[m==="completed"||_!=null&&_.length?(t(),y(i,{key:0,class:"p-button p-button-text w-full justify-between",to:a(M)({id:r,axeId:_[0].id,status:m,reportType:j})},{default:l(()=>[d("span",z,L(o.title),1),d("span",D,[m==="completed"?(t(),n(v,{key:0},[w("See report")],64)):(t(),n(v,{key:1},[w("See results")],64))])]),_:2},1032,["to"])):(t(),n("div",F,L(o.title),1))]))),128))])):(t(),n("p",T,"Your audit list is empty"))]),_:2},[c.audits.length?{name:"footer",fn:l(()=>[h(i,{class:"p-button",to:"/audit/?user=me"},{default:l(()=>u[1]||(u[1]=[w(" See all my audits ")])),_:1})]),key:"0"}:void 0]),1024)}}}),G={key:1,"aria-labelledby":"project-card-title",class:"grid space-y-2"},H={class:"text-left"},J={key:2},K=S({__name:"ProjectList",props:{projects:{},initialCount:{default:0},step:{default:5},isLoading:{type:Boolean,default:!1}},setup(f){const e=f,s=k(e.initialCount?e.initialCount:e.projects.length),p=()=>{s.value=s.value+e.step},c=C(()=>e.projects.slice(0,s.value)),u=C(()=>e.projects.length>0&&e.initialCount&&s.value<e.projects.length);return(g,i)=>{const b=N,r=$,o=x("Button"),_=x("Card");return t(),y(_,null,A({title:l(()=>[i[0]||(i[0]=d("h2",{id:"project-card-title"},"Your projects",-1))]),content:l(()=>[g.isLoading?(t(),y(b,{key:0,class:"mx-auto w-20"})):a(c).length?(t(),n("ul",G,[(t(!0),n(v,null,P(a(c),({id:m,name:j})=>(t(),n("li",{key:m},[h(r,{class:"p-button p-button-link grid w-full justify-between",to:`/audit/?projectId=${m}`},{default:l(()=>[d("span",H,L(j),1),i[1]||(i[1]=d("span",{class:"p-button p-button-info ml-4"},"See all audits",-1))]),_:2},1032,["to"])]))),128))])):(t(),n("p",J,"Your projects list is empty"))]),_:2},[a(u)?{name:"footer",fn:l(()=>[h(o,{onClick:p},{default:l(()=>i[2]||(i[2]=[w("Show more projects")])),_:1})]),key:"0"}:void 0]),1024)}}}),O={class:"grid grid-cols-1 space-y-8"},Q={class:"flex flex-wrap justify-between space-y-6 sm:flex-nowrap sm:space-y-0"},tt=S({__name:"index",setup(f){const{user:e,isViewer:s}=V(),p=k([]),c=k([]),u=k(!0);async function g(){const r=B();try{const{data:o}=await r.from("projects").select("*",{count:"exact"}).order("created_at",{ascending:!0});p.value=o||[]}catch(o){console.error("Error fetching projects:",o)}}async function i(){const r=B(),{data:o}=await r.from("audits").select("*, axe (id)").order("created_at",{ascending:!1}).eq("profile_id",e.value.id);c.value=o||[]}async function b(){try{await Promise.all([i(),g()])}catch(r){console.error("Error fetching data:",r)}finally{u.value=!1}}return Y(async()=>await b()),(r,o)=>{const _=$,m=U,j=K;return t(),n("div",O,[d("div",Q,[o[1]||(o[1]=d("h1",null,"Your a11y tools",-1)),h(_,{class:"p-button p-button-lg w-full justify-center sm:w-2/5",to:"/audit/new"},{default:l(()=>o[0]||(o[0]=[w(" Create new audit ")])),_:1})]),d("div",{class:I(["grid gap-4",{"md:w-3/5 md:grid-cols-1":a(s),"md:grid-cols-2":!a(s)}])},[a(s)?E("",!0):(t(),y(m,{key:0,audits:a(c),"initial-count":5,"is-loading":a(u)},null,8,["audits","is-loading"])),h(j,{projects:a(p),"initial-count":5,"is-loading":a(u)},null,8,["projects","is-loading"])],2)])}}});export{tt as default};
