import{d as q,u as B,a as L,r as M,w as P,i as j,S as z,b as U,o as i,c as m,e as s,f as d,g as O,h as R,j as e,k as $,l as _,n as y,t as b,m as f}from"./entry.bde0faaf.js";import{u as G,a as H,b as J,d as K}from"./form.41b0e6ae.js";import"./screenSizes.19d85ebf.js";const Q={class:"grid"},W={class:"mb-6 grid gap-6 md:grid-cols-2 md:items-start md:gap-x-8"},X={class:"w-full"},Y={key:0,class:"p-error mt-1"},Z={class:"w-full"},ee={key:0,class:"p-error mt-1"},ae={class:"w-full"},le={key:0,class:"p-error mt-1"},se={class:"w-full"},te={key:0,class:"p-error mt-1"},oe={class:"w-full"},ne={key:0,class:"p-error mt-1"},pe=q({__name:"index",async setup(re){let w,k;const V=B(),x=L(),p={email:"",username:"",fullName:"",avatarUrl:"",userType:""},F=["auditor","viewer"],c=M(!0);if(V.value){const{data:t}=([w,k]=P(()=>x.from("profiles").select("username, full_name, avatar_url, user_type").eq("id",V.value.id).single()),w=await w,k(),w);t&&(p.email=V.value.email||"",p.username=t.username||"",p.fullName=t.full_name||"",p.avatarUrl=t.avatar_url||"",p.userType=t.user_type||""),c.value=!1}const{useFieldModel:v,handleSubmit:I,errors:l,submitCount:A}=G({validationSchema:J,initialValues:p}),S=v("email"),g=v("username"),N=v("fullName"),T=v("avatarUrl"),C=v("userType"),{isSubmitted:n}=H(A),E=I(async t=>{var a;try{c.value=!0;const u=B();if((a=u.value)!=null&&a.id){const{error:r}=await x.from("profiles").update({username:t.username,full_name:t.fullName,updated_at:new Date().toISOString()}).eq("id",u.value.id);if(r)throw j(r)?new z(r):new Error((r==null?void 0:r.message)||"")}}catch(u){const{$handleError:r}=R();r(u)}finally{c.value=!1}},({errors:t})=>K(t));return(t,a)=>{const u=U("InputText"),r=U("Dropdown"),D=U("Button"),h=U("Card");return i(),m("div",Q,[a[11]||(a[11]=s("h1",null,"Account Profile",-1)),d(h,null,{content:O(()=>[e(V)?(i(),m("form",{key:0,onSubmit:a[5]||(a[5]=$((...o)=>e(E)&&e(E)(...o),["prevent"]))},[s("div",W,[s("span",X,[a[6]||(a[6]=s("label",{for:"email"},"Email",-1)),d(u,{id:"email",modelValue:e(S),"onUpdate:modelValue":a[0]||(a[0]=o=>_(S)?S.value=o:null),disabled:"",readonly:"",class:y(["w-full",[{"p-invalid":e(l).email&&e(n)}]]),"data-testid":"account-email-field",name:"email"},null,8,["modelValue","class"]),e(l).email&&e(n)?(i(),m("small",Y,b(e(l).email),1)):f("",!0)]),s("span",Z,[a[7]||(a[7]=s("label",{for:"username"},"Username",-1)),d(u,{id:"username",modelValue:e(g),"onUpdate:modelValue":a[1]||(a[1]=o=>_(g)?g.value=o:null),class:y(["w-full",[{"p-invalid":e(l).username&&e(n)}]]),"data-testid":"account-username-field",name:"username"},null,8,["modelValue","class"]),e(l).username&&e(n)?(i(),m("small",ee,b(e(l).username),1)):f("",!0)]),s("span",ae,[a[8]||(a[8]=s("label",{for:"full_name"},"Full name",-1)),d(u,{id:"full_name",modelValue:e(N),"onUpdate:modelValue":a[2]||(a[2]=o=>_(N)?N.value=o:null),class:y(["w-full",[{"p-invalid":e(l).fullName&&e(n)}]]),"data-testid":"account-fullName-field",name:"fullName"},null,8,["modelValue","class"]),e(l).fullName&&e(n)?(i(),m("small",le,b(e(l).fullName),1)):f("",!0)]),s("span",se,[a[9]||(a[9]=s("label",{for:"avatar_url"},"Avatar url (soon)",-1)),d(u,{id:"avatar_url",modelValue:e(T),"onUpdate:modelValue":a[3]||(a[3]=o=>_(T)?T.value=o:null),class:y(["w-full",[{"p-invalid":e(l).avatarUrl&&e(n)}]]),"data-testid":"account-avatarUrl-field",name:"avatarUrl",disabled:"",readonly:""},null,8,["modelValue","class"]),e(l).avatarUrl&&e(n)?(i(),m("small",te,b(e(l).avatarUrl),1)):f("",!0)]),s("span",oe,[a[10]||(a[10]=s("label",{for:"user_type"},"User type (soon)",-1)),d(r,{id:"user_type",modelValue:e(C),"onUpdate:modelValue":a[4]||(a[4]=o=>_(C)?C.value=o:null),options:F,placeholder:"Select",class:y(["md:w-14rem w-full",[{"p-invalid":e(l).userType&&e(n)}]]),"data-testid":"account-userType-field",name:"userType"},null,8,["modelValue","class"]),e(l).userType&&e(n)?(i(),m("small",ne,b(e(l).userType),1)):f("",!0)])]),d(D,{label:e(c)?"Loading ...":"Update",type:"submit",class:"p-button-lg w-full","data-testid":"account-submit-button",loading:e(c)},null,8,["label","loading"])],32)):f("",!0)]),_:1})])}}});export{pe as default};
